# ๐๏ธ ุญุฐู ุชููุงุฆู ููุบุฑู ุงููุงุฑุบุฉ

## ุงูููุฒุฉ
ุนูุฏูุง ูุตุจุญ ุนุฏุฏ ุงููุดุงุฑููู ูู ุงูุบุฑูุฉ = **0**ุ ูุชู **ุญุฐู ุงูุบุฑูุฉ ุชููุงุฆูุงู** โ

---

## ููู ูุนููุ

### Database Trigger
```sql
CREATE TRIGGER trigger_auto_delete_empty_rooms
AFTER UPDATE OF participants_count ON voice_rooms
WHEN (participants_count = 0)
โ DELETE ุงูุบุฑูุฉ
```

### Flow
```
ุขุฎุฑ ูุดุงุฑู ูุบุงุฏุฑ
  โ
ูุชู ุญุฐูู ูู voice_room_participants
  โ
Trigger ูุญุฏูุซ participants_count โ 0
  โ
Trigger ุขุฎุฑ ูุญุฐู ุงูุบุฑูุฉ ุชููุงุฆูุงู โ
```

---

## ุงูุชุทุจูู

### 1. ูููุฐ SQL
```bash
# ูู Supabase SQL Editor
ูููุฐ: auto_delete_empty_rooms.sql
```

### 2. ุงุฎุชุจุฑ
1. ุฃูุดุฆ ุบุฑูุฉ
2. ุงูุถู ููุบุฑูุฉ
3. ุงุฎุฑุฌ ูู ุงูุบุฑูุฉ
4. โ ุงูุบุฑูุฉ ุชูุญุฐู ุชููุงุฆูุงู!

---

## ุงููููุฒุงุช

โ **ุชููุงุฆู** - ูุง ุญุงุฌุฉ ูููุฏ ุฅุถุงูู
โ **ููุซูู** - ูุนูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
โ **ููุฑู** - ูุญุฐู ูุจุงุดุฑุฉ
โ **ูุธูู** - ูุง ุบุฑู ูุงุฑุบุฉ ุนุงููุฉ

---

## ููุงุญุธุงุช

- ุงูู Trigger ูุนูู **ููุท** ุนูุฏูุง ูุตุจุญ ุงูุนุฏุฏ 0
- ููุญุฐู ุงูุบุฑูุฉ **ููู ุจูุงูุงุชูุง** (CASCADE)
- ูู ุชุธูุฑ ุงูุบุฑูุฉ ูู ุงููุงุฆูุฉ ุจุนุฏ ุงูุญุฐู
- ูุซุงูู ููุญูุงุธ ุนูู ูุงุนุฏุฉ ุจูุงูุงุช ูุธููุฉ

---

## ุงูุฃูุงู

- ุงูู Trigger ูุนูู ุจุตูุงุญูุงุช SECURITY DEFINER
- ูุง ูููู ูููุณุชุฎุฏููู ุงูุชูุงุนุจ ุจู
- ูุนูู ุชููุงุฆูุงู ูู ุงูุฎูููุฉ

ูููุฐ ุงูุขู! ๐
